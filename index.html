<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Excel Data Dashboard</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/exceljs/4.3.0/exceljs.min.js"></script>
</head>
<body>
    <h1>Data from XLSM</h1>
    <div id="data-output"></div>

    <script>
        async function loadExcelFile() {
            const fileUrl = 'data.xlsm';  // Ujisti se, že tento soubor je v root adresáři GitHub Pages

            // Načtení souboru pomocí fetch API
            const response = await fetch(fileUrl);
            const arrayBuffer = await response.arrayBuffer();

            // Načtení XLSM souboru pomocí ExcelJS
            const workbook = new ExcelJS.Workbook();
            await workbook.xlsx.load(arrayBuffer);  // XLSM je podporován stejně jako XLSX

            // Předpokládáme, že data jsou na listě "DJE"
            const worksheet = workbook.getWorksheet('DJE');

            const dataOutput = document.getElementById('data-output');
            dataOutput.innerHTML = '';  // Vyčistíme výstupní div

            // Procházení řádků sloupce B a zobrazení dat
            worksheet.eachRow((row, rowNumber) => {
                const cellValue = row.getCell('B').value;  // Získání hodnoty ze sloupce B
                if (cellValue) {
                    const div = document.createElement('div');
                    div.textContent = `Row ${rowNumber}: ${cellValue}`;
                    dataOutput.appendChild(div);
                }
            });
        }

        // Zavolání funkce pro načtení dat
        loadExcelFile();
    </script>
</body>
</html>
